<section class="buyers-only-hub" data-buyers-only-page-guard data-buyers-only-gate-url="{{ section.settings.gate_url | default: '/pages/buyers-only' }}" style="--animation-duration: {{ section.settings.animation_duration | default: 600 }}ms; --grayscale-intensity: {{ section.settings.grayscale_intensity | default: 100 }}%;">
  <div class="buyers-only-hub__container">
    {%- for block in section.blocks -%}
      {%- if block.type == 'card' -%}
        <div class="buyers-only-hub__card" {{ block.shopify_attributes }}>
          {%- if block.settings.background_image != blank -%}
            <div class="buyers-only-hub__card-bg" style="background-image: url('{{ block.settings.background_image | image_url: width: 2400 }}');"></div>
          {%- else -%}
            <div class="buyers-only-hub__card-bg" style="background-color: #f5f5f5;"></div>
          {%- endif -%}
          <div class="buyers-only-hub__card-overlay" style="opacity: {{ block.settings.overlay_opacity | divided_by: 100.0 }};"></div>
          <div class="buyers-only-hub__card-content">
            <h2 class="buyers-only-hub__card-heading font-serif" style="font-size: {{ block.settings.heading_font_size | default: 3.5 }}rem;">{{ block.settings.heading | default: 'Card ' | append: forloop.index }}</h2>
            {%- if block.settings.button_text != blank -%}
              {%- assign action_type = block.settings.button_action | default: 'url' -%}
              {%- if action_type == 'url' and block.settings.button_url != blank -%}
                <a href="{{ block.settings.button_url }}" class="buyers-only-hub__card-btn buyers-only-hub__card-btn--{{ block.settings.button_size | default: 'medium' }} btn btn-default">{{ block.settings.button_text }}</a>
              {%- elsif action_type == 'pdf_viewer' -%}
                <button class="buyers-only-hub__card-btn buyers-only-hub__card-btn--{{ block.settings.button_size | default: 'medium' }} btn btn-default" type="button" data-modal-trigger="pdf-viewer" data-pdf-url="{{ block.settings.pdf_file }}">{{ block.settings.button_text }}</button>
              {%- elsif action_type == 'contact_form' -%}
                <button class="buyers-only-hub__card-btn buyers-only-hub__card-btn--{{ block.settings.button_size | default: 'medium' }} btn btn-default" type="button" data-modal-trigger="contact-form">{{ block.settings.button_text }}</button>
              {%- else -%}
                <button class="buyers-only-hub__card-btn buyers-only-hub__card-btn--{{ block.settings.button_size | default: 'medium' }} btn btn-default" type="button">{{ block.settings.button_text }}</button>
              {%- endif -%}
            {%- endif -%}
          </div>
        </div>
      {%- endif -%}
    {%- endfor -%}
  </div>

  <div class="buyers-only-hub__modal" id="buyers-only-pdf-modal" data-modal="pdf-viewer">
    <div class="buyers-only-hub__modal-backdrop" data-modal-close></div>
    <div class="buyers-only-hub__modal-content">
      <button class="buyers-only-hub__modal-close" data-modal-close aria-label="Close">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <div class="buyers-only-hub__pdf-viewer">
        <iframe id="buyers-only-pdf-iframe" src="" frameborder="0" allowfullscreen></iframe>
      </div>
      <div class="buyers-only-hub__pdf-actions">
        <a id="buyers-only-pdf-download" href="" download class="btn btn-default">Download PDF</a>
      </div>
    </div>
  </div>

  <div class="buyers-only-hub__modal" id="buyers-only-contact-modal" data-modal="contact-form">
    <div class="buyers-only-hub__modal-backdrop" data-modal-close></div>
    <div class="buyers-only-hub__modal-content buyers-only-hub__modal-content--form">
      <button class="buyers-only-hub__modal-close" data-modal-close aria-label="Close">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <div class="buyers-only-hub__form-container">
        <h3 class="buyers-only-hub__form-title font-serif">{{ section.settings.form_heading | default: 'Contact Us' }}</h3>
        {%- form 'contact', id: 'buyers-only-contact-form', class: 'buyers-only-hub__form' -%}
          {%- if form.posted_successfully? -%}
            <div class="buyers-only-hub__form-success">
              <p>{{ section.settings.form_success_message | default: 'Thank you! We will get back to you shortly.' }}</p>
            </div>
          {%- endif -%}
          {%- if form.errors -%}
            <div class="buyers-only-hub__form-errors">
              {{ form.errors | default_errors }}
            </div>
          {%- endif -%}
          <input type="hidden" name="contact[subject]" value="{{ section.settings.form_subject | default: 'BUYERS ONLY Contact' }}">
          <div class="buyers-only-hub__form-grid">
            <div class="buyers-only-hub__form-field">
              <label for="contact-name">Name *</label>
              <input id="contact-name" type="text" name="contact[name]" required>
            </div>
            <div class="buyers-only-hub__form-field">
              <label for="contact-company">Company *</label>
              <input id="contact-company" type="text" name="contact[company]" required>
            </div>
            <div class="buyers-only-hub__form-field">
              <label for="contact-role">Role *</label>
              <select id="contact-role" name="contact[role]" required>
                <option value="">Select role</option>
                <option value="Buyer">Buyer</option>
                <option value="Agent">Agent</option>
                <option value="Press">Press</option>
              </select>
            </div>
            <div class="buyers-only-hub__form-field">
              <label for="contact-country">Country *</label>
              <input id="contact-country" type="text" name="contact[country]" required>
            </div>
            <div class="buyers-only-hub__form-field">
              <label for="contact-email">Email *</label>
              <input id="contact-email" type="email" name="contact[email]" required>
            </div>
            <div class="buyers-only-hub__form-field">
              <label for="contact-interest">Interest *</label>
              <select id="contact-interest" name="contact[interest]" required>
                <option value="">Select interest</option>
                <option value="Order">Order</option>
                <option value="Representation">Representation</option>
                <option value="Press">Press</option>
              </select>
            </div>
            <div class="buyers-only-hub__form-field buyers-only-hub__form-field--full">
              <label for="contact-message">Message</label>
              <textarea id="contact-message" name="contact[body]" rows="5"></textarea>
            </div>
          </div>
          <button type="submit" class="btn btn-default buyers-only-hub__form-submit">{{ section.settings.form_button_text | default: 'Send Message' }}</button>
        {%- endform -%}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "BUYERS ONLY Hub",
  "settings": [
    {
      "type": "text",
      "id": "gate_url",
      "label": "Gate page URL",
      "default": "/pages/buyers-only"
    },
    {
      "type": "range",
      "id": "animation_duration",
      "label": "Animation duration (ms)",
      "min": 300,
      "max": 1200,
      "step": 100,
      "default": 600,
      "unit": "ms"
    },
    {
      "type": "range",
      "id": "grayscale_intensity",
      "label": "Grayscale intensity",
      "min": 0,
      "max": 100,
      "step": 10,
      "default": 100,
      "unit": "%"
    },
    {
      "type": "text",
      "id": "form_heading",
      "label": "Contact form heading",
      "default": "Get in Touch"
    },
    {
      "type": "text",
      "id": "form_subject",
      "label": "Contact form email subject",
      "default": "BUYERS ONLY Contact"
    },
    {
      "type": "text",
      "id": "form_button_text",
      "label": "Contact form button text",
      "default": "Send Message"
    },
    {
      "type": "textarea",
      "id": "form_success_message",
      "label": "Contact form success message",
      "default": "Thank you! We will get back to you shortly."
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "background_image",
          "label": "Background image"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": "Overlay opacity",
          "min": 0,
          "max": 90,
          "step": 5,
          "default": 40,
          "unit": "%"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "range",
          "id": "heading_font_size",
          "label": "Heading font size",
          "min": 1.5,
          "max": 6,
          "step": 0.5,
          "default": 3.5,
          "unit": "rem"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text",
          "default": "Explore"
        },
        {
          "type": "select",
          "id": "button_size",
          "label": "Button size",
          "options": [
            { "value": "small", "label": "Small" },
            { "value": "medium", "label": "Medium" },
            { "value": "large", "label": "Large" }
          ],
          "default": "medium"
        },
        {
          "type": "select",
          "id": "button_action",
          "label": "Button action",
          "options": [
            { "value": "url", "label": "Open URL" },
            { "value": "pdf_viewer", "label": "View PDF" },
            { "value": "contact_form", "label": "Contact Form" }
          ],
          "default": "url",
          "info": "Choose what happens when the button is clicked"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Button URL",
          "info": "Only used when action is 'Open URL'"
        },
        {
          "type": "url",
          "id": "pdf_file",
          "label": "PDF file URL",
          "info": "Only used when action is 'View PDF'. Upload PDF to Files and paste URL here"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "BUYERS ONLY Hub",
      "category": "Text",
      "blocks": [
        { "type": "card" },
        { "type": "card" },
        { "type": "card" },
        { "type": "card" }
      ]
    }
  ]
}
{% endschema %}
