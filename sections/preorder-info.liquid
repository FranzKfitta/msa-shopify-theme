{% comment %}
  Section: How pre-orders work
  Use this section on a dedicated page template to explain the pre-order process.
{% endcomment %}

<section class="preorder-info" data-preorder-section>
  <div class="preorder-info-inner">
    <header class="preorder-info-header">
      <h1 class="preorder-title" id="preorder-modal-title">{{ section.settings.heading }}</h1>
      {% if section.settings.show_intro and section.settings.intro_text != blank %}
        <p class="preorder-intro">{{ section.settings.intro_text }}</p>
      {% endif %}
    </header>

    <div class="preorder-layout">
      <div class="preorder-steps" data-preorder-carousel>
        {% if section.blocks.size > 1 %}
          <div class="preorder-step-header">
            <div class="preorder-step-dots" data-preorder-dots>
              {% for block in section.blocks %}
                <button type="button" class="preorder-step-dot{% if forloop.first %} is-active{% endif %}" data-step-dot data-step-index="{{ forloop.index0 }}" aria-label="Go to step {{ forloop.index }}">
                  {{ forloop.index }}
                </button>
              {% endfor %}
            </div>
          </div>
        {% endif %}

        <div class="preorder-steps-track">
          {% for block in section.blocks %}
            <article class="preorder-step{% if forloop.first %} is-active{% endif %}" data-preorder-step data-step-index="{{ forloop.index0 }}" {{ block.shopify_attributes }}>
              <div class="preorder-step-inner">
                <div class="preorder-step-image">
                  {% if block.settings.image != blank %}
                    <div class="preorder-step-image-inner">
                      {{ block.settings.image | image_url: width: 1200 | image_tag: loading: 'lazy', class: 'w-full h-full object-cover' }}
                    </div>
                  {% endif %}
                </div>
                {% assign panel_size = block.settings.panel_size | default: 'medium' %}
                {% assign panel_styles = '' %}
                {% if block.settings.text_color != blank %}
                  {% assign panel_styles = panel_styles | append: 'color: ' | append: block.settings.text_color | append: ';' %}
                {% endif %}
                {% if block.settings.font_size_px %}
                  {% assign panel_styles = panel_styles | append: 'font-size: ' | append: block.settings.font_size_px | append: 'px;' %}
                {% endif %}
                <div class="preorder-step-panel preorder-step-panel--{{ panel_size }}"{% if block.settings.panel_bg_color != blank %} style="background-color: {{ block.settings.panel_bg_color }};"{% endif %}>
                  <div class="preorder-step-number-pill">{{ forloop.index }}</div>
                  <div class="preorder-step-panel-content preorder-step-panel-content--{{ panel_size }}"{% if panel_styles != '' %} style="{{ panel_styles }}"{% endif %}>
                    {% if block.settings.title != blank %}
                      <h3 class="preorder-step-title">{{ block.settings.title }}</h3>
                    {% endif %}
                    {% if block.settings.text != blank %}
                      <div class="preorder-step-text">{{ block.settings.text }}</div>
                    {% endif %}
                    {% if block.settings.link_label != blank and block.settings.link_url != blank %}
                      <a href="{{ block.settings.link_url }}" class="preorder-step-link">
                        {{ block.settings.link_label }}
                      </a>
                    {% endif %}
                  </div>
                </div>
              </div>
            </article>
          {% endfor %}
        </div>

        {% if section.blocks.size > 1 %}
          <div class="preorder-step-controls">
            <button type="button" class="preorder-step-nav preorder-step-prev" data-preorder-prev aria-label="Previous step">
              &#8592;
            </button>
            <button type="button" class="preorder-step-nav preorder-step-next" data-preorder-next aria-label="Next step">
              &#8594;
            </button>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "How pre-orders work",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section heading",
      "default": "HOW DOES PRE-ORDERING WORK?"
    },
    {
      "type": "checkbox",
      "id": "show_intro",
      "label": "Show intro subheading",
      "default": true
    },
    {
      "type": "textarea",
      "id": "intro_text",
      "label": "Intro text",
      "default": "We produce each pre-order especially for you, in limited runs, to slow fashion down and focus on quality."
    },
    {
      "type": "text",
      "id": "why_title",
      "label": "'Why pre-order' heading",
      "default": "Why pre-order?"
    },
    {
      "type": "richtext",
      "id": "why_text",
      "label": "'Why pre-order' text",
      "default": "<p>Pre-ordering allows us to create pieces only when they are truly desired, instead of overproducing and holding unnecessary stock.</p>"
    },
    {
      "type": "text",
      "id": "benefits_title",
      "label": "Benefits heading",
      "default": "What it makes possible"
    },
    {
      "type": "richtext",
      "id": "benefits_text",
      "label": "Benefits text",
      "default": "<ul><li>Reduces overproduction and leftover stock.</li><li>Helps us choose better materials and work with small, expert workshops.</li><li>Supports a slower rhythm where each piece is made with care just for you.</li></ul>"
    }
  ],
  "blocks": [
    {
      "type": "preorder_step",
      "name": "Pre-order step",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Step image"
        },
        {
          "type": "color",
          "id": "panel_bg_color",
          "label": "Panel background color",
          "default": "#e5f3f7"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text color",
          "default": "#111111"
        },
        {
          "type": "select",
          "id": "panel_size",
          "label": "Panel size",
          "default": "medium",
          "options": [
            {
              "value": "small",
              "label": "Small"
            },
            {
              "value": "medium",
              "label": "Medium"
            },
            {
              "value": "large",
              "label": "Large"
            }
          ]
        },
        {
          "type": "range",
          "id": "font_size_px",
          "label": "Body font size",
          "min": 14,
          "max": 30,
          "step": 1,
          "unit": "px",
          "default": 18
        },
        {
          "type": "text",
          "id": "title",
          "label": "Step title",
          "default": "You place your pre-order"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Step text",
          "default": "<p>You choose your piece and size during a limited pre-order window.</p>"
        },
        {
          "type": "text",
          "id": "link_label",
          "label": "Link label",
          "default": "Discover the next step"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Link URL"
        }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "How pre-orders work",
      "category": "Text",
      "blocks": [
        { "type": "preorder_step" },
        { "type": "preorder_step" },
        { "type": "preorder_step" },
        { "type": "preorder_step" }
      ]
    }
  ]
}
{% endschema %}
