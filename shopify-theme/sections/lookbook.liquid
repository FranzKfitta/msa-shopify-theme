{% schema %}
{
  "name": "Lookbook",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Seasonal Lookbook"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Discover our latest collection through carefully curated looks"
    },
    {
      "type": "header",
      "content": "Collection Settings"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection",
      "info": "Select a collection to display products from"
    }
  ],
  "blocks": [
    {
      "type": "lookbook_item",
      "name": "Lookbook Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Lookbook Image",
          "info": "Recommended size: 800x1200px (3:4 aspect ratio)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Look Title",
          "default": "The Classic Look"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Look Description",
          "default": "Timeless elegance meets modern sophistication"
        },
        {
          "type": "product",
          "id": "featured_product",
          "label": "Featured Product",
          "info": "Product to highlight in this look"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Shop Link",
          "info": "Link to shop this look (optional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Lookbook",
      "blocks": [
        {
          "type": "lookbook_item"
        },
        {
          "type": "lookbook_item"
        },
        {
          "type": "lookbook_item"
        },
        {
          "type": "lookbook_item"
        }
      ]
    }
  ]
}
{% endschema %}

<section class="min-h-screen bg-gradient-to-b from-background to-secondary/20">
  <!-- Header -->
  <div class="container mx-auto px-4 py-16 md:py-24">
    <div class="text-center max-w-4xl mx-auto">
      <h1 class="font-serif text-4xl md:text-6xl lg:text-7xl mb-6 text-foreground">
        {{ section.settings.title }}
      </h1>
      <p class="text-lg md:text-xl text-muted-foreground leading-relaxed max-w-2xl mx-auto">
        {{ section.settings.description }}
      </p>
    </div>
  </div>

  <!-- Lookbook Grid -->
  <div class="container mx-auto px-4 pb-16 md:pb-24">
    <div class="lookbook-grid">
      {%- for block in section.blocks -%}
        <div class="lookbook-item group relative overflow-hidden rounded-lg shadow-elegant hover:shadow-xl transition-all duration-500">
          <!-- Image -->
          <div class="aspect-[3/4] overflow-hidden bg-secondary relative">
            {%- if block.settings.image != blank -%}
              <img
                src="{{ block.settings.image | image_url: width: 800 }}"
                alt="{{ block.settings.title | escape }}"
                class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                loading="lazy"
                width="{{ block.settings.image.width }}"
                height="{{ block.settings.image.height }}"
              >
            {%- else -%}
              {%- assign placeholder_image = 'lookbook-fw25/look-' | append: forloop.index | append: '.svg' -%}
              <img
                src="{{ placeholder_image | asset_url }}"
                alt="{{ block.settings.title | escape }}"
                class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                loading="lazy"
              >
            {%- endif -%}
            
            <!-- Look Number -->
            <div class="absolute top-4 left-4 z-10">
              <span class="inline-block px-3 py-1 bg-background/90 backdrop-blur-sm text-foreground text-sm font-medium rounded-full">
                Look {{ forloop.index }}
              </span>
            </div>
          </div>

          <!-- Overlay Content -->
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <div class="absolute bottom-0 left-0 right-0 p-6 text-white">
              {%- if block.settings.title != blank -%}
                <h3 class="font-serif text-xl mb-2">{{ block.settings.title }}</h3>
              {%- endif -%}
              
              {%- if block.settings.description != blank -%}
                <p class="text-sm text-white/90 mb-4 line-clamp-2">{{ block.settings.description }}</p>
              {%- endif -%}

              {%- if block.settings.featured_product != blank -%}
                <div class="mb-4">
                  <p class="text-xs text-white/70 mb-1">Featured:</p>
                  <p class="text-sm font-medium">{{ block.settings.featured_product.title }}</p>
                  <p class="text-sm text-white/90">{{ block.settings.featured_product.price | money }}</p>
                </div>
              {%- endif -%}

              {%- if block.settings.link != blank or block.settings.featured_product != blank -%}
                <a href="{{ block.settings.link | default: block.settings.featured_product.url }}" class="inline-flex items-center gap-2 text-sm font-medium tracking-wide hover:gap-3 transition-all">
                  SHOP THIS LOOK
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="7" y1="17" x2="17" y2="7"></line>
                    <polyline points="7 7 17 7 17 17"></polyline>
                  </svg>
                </a>
              {%- endif -%}
            </div>
          </div>
        </div>
      {%- endfor -%}
    </div>

    <!-- Collection Products (if collection is selected) -->
    {%- if section.settings.collection != blank -%}
      <div class="mt-24">
        <div class="text-center mb-12">
          <h2 class="font-serif text-3xl md:text-4xl mb-4">Shop the Collection</h2>
          <p class="text-muted-foreground">Complete your look with pieces from this collection</p>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
          {%- for product in section.settings.collection.products limit: 8 -%}
            <div class="product-card group">
              <div class="aspect-[3/4] overflow-hidden bg-secondary rounded-lg mb-4 relative">
                <a href="{{ product.url }}" class="block w-full h-full">
                  {%- if product.featured_image != blank -%}
                    <img
                      src="{{ product.featured_image | image_url: width: 600 }}"
                      alt="{{ product.featured_image.alt | escape }}"
                      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                      loading="lazy"
                      width="{{ product.featured_image.width }}"
                      height="{{ product.featured_image.height }}"
                    >
                  {%- else -%}
                    {{ 'product-1.jpg' | asset_url | image_tag: loading: 'lazy', class: 'w-full h-full object-cover' }}
                  {%- endif -%}
                  
                  <!-- Quick View Overlay -->
                  <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <span class="bg-white text-foreground px-4 py-2 rounded-md text-sm font-medium">
                      Quick View
                    </span>
                  </div>
                </a>
              </div>
              
              <div class="text-center">
                <h3 class="font-medium text-sm mb-1 line-clamp-1">
                  <a href="{{ product.url }}" class="hover:text-primary transition-colors">
                    {{ product.title }}
                  </a>
                </h3>
                <p class="text-sm text-muted-foreground">
                  {{ product.price | money }}
                  {%- if product.compare_at_price > product.price -%}
                    <span class="line-through ml-1 text-xs">{{ product.compare_at_price | money }}</span>
                  {%- endif -%}
                </p>
              </div>
            </div>
          {%- endfor -%}
        </div>

        {%- if section.settings.collection.products.size > 8 -%}
          <div class="text-center mt-12">
            <a href="{{ section.settings.collection.url }}" class="btn btn-outline">
              View All Products
            </a>
          </div>
        {%- endif -%}
      </div>
    {%- endif -%}
  </div>
</section>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>